; OPcache 本番用設定
; FukuPochi Laravel Backend
; パフォーマンス最適化

[opcache]

; OPcache を有効にする
opcache.enable = 1
opcache.enable_cli = 1

; 共有メモリのサイズ（MB）
; Laravel アプリケーションに適した設定
opcache.memory_consumption = 128

; インターン化された文字列のバッファサイズ（MB）
opcache.interned_strings_buffer = 8

; ハッシュテーブルの最大ファイル数
; Laravel の一般的なファイル数に対応
opcache.max_accelerated_files = 4000

; ファイルの更新チェック頻度（秒）
; 本番環境では頻繁にチェックしない
opcache.revalidate_freq = 60

; ファイルタイムスタンプの検証を無効にする
; 本番環境では true で最高のパフォーマンス
opcache.validate_timestamps = 1

; Fast shutdown を有効にする
opcache.fast_shutdown = 1

; コメントを保存する（Laravel Reflection で必要）
opcache.save_comments = 1

; ファイルキャッシュの有効化
opcache.file_cache = /tmp/opcache

; ファイルキャッシュのみ使用（共有メモリと併用）
opcache.file_cache_only = 0

; ファイルキャッシュの一貫性チェック
opcache.file_cache_consistency_checks = 1

; 最適化レベル
opcache.optimization_level = 0x7FFFBFFF

; JITの設定（PHP 8.0+）
opcache.jit = tracing
opcache.jit_buffer_size = 64M

; プリロードの設定（必要に応じて有効化）
; opcache.preload = /var/www/html/preload.php
; opcache.preload_user = www-data

; ログ設定
opcache.log_verbosity_level = 1
opcache.error_log = /var/log/php/opcache.log

; 統計情報を有効にする（開発・デバッグ時のみ）
opcache.enable_file_override = 0

; 巨大ファイルの閾値（バイト）
opcache.huge_code_pages = 1

; SHMセグメントの最大数
opcache.max_wasted_percentage = 5

; プロセス間でのOPcache統計情報共有
opcache.use_cwd = 1

; ファイルの除外パターン
; opcache.blacklist_filename = /etc/php/opcache-blacklist.txt